Include modsecurity.conf

Include /usr/local/owasp-modsecurity-crs/crs-setup.conf
Include /usr/local/owasp-modsecurity-crs/rules/*.conf

SecRule REQUEST_METHOD "^(TRACE|TRACK)$" \
    "id:1000,phase:1,deny,status:405,log,msg:'TRACE or TRACK method not allowed'"

SecRule REQUEST_HEADERS:User-Agent "nikto|sqlmap|w3af|acunetix|havij" \
    "id:1001,phase:1,deny,status:403,log,msg:'Malicious User-Agent detected'"

SecRule IP:REQ_RATE "@gt 100" \
    "id:1002,phase:1,pass,log,msg:'Rate limit exceeded',setvar:ip.req_rate=+1,expirevar:ip.req_rate=60"

SecRule REQUEST_FILENAME "@streq /api/" \
    "id:1003,phase:1,t:none,pass,nolog,ctl:ruleEngine=On"

SecRule REQUEST_FILENAME "@contains /wss" \
    "id:1004,phase:1,t:none,pass,nolog,ctl:ruleEngine=DetectionOnly"

SecRule REQUEST_FILENAME "@contains /ws" \
    "id:1005,phase:1,t:none,pass,nolog,ctl:ruleEngine=DetectionOnly"
